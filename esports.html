<!-- Modifications copyright (C) 2019 Kamil Szurant -->

<!DOCTYPE html>
<html lang = "en">

<head>
    <title>Beat Aim - Rhythm Shooter</title>
    <meta charset="UTF-8">
    <meta name="description"
        content="Beat Aim - rhythm game designed for FPS players with ai generated maps. Makes improving your aim incredibly fun while listening to your favorite songs.">
    <meta name="keywords" content="beat aim, beat,aim,beataim,shooter,trainer,practice,rhythm,3d,ai,kamyker">
    <meta name="author" content="Kamil Szurant">
    <meta property="og:title" content="Beat Aim">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://beataim.com/meta-image.jpg">
    <meta property="og:url" content="https://beataim.com">
    <meta property="og:description"
        content="Rhythm game designed for FPS players with ai generated maps. Makes improving your aim incredibly fun while listening to your favorite songs.">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@beat_aim">
    <meta name="twitter:creator" content="@kamyker">
    <meta name="twitter:title" content="Beat Aim">
    <meta name="twitter:description"
        content="Rhythm game designed for FPS players with ai generated maps. Makes improving your aim incredibly fun while listening to your favorite songs.">
    <meta name="twitter:image" content="https://beataim.com/meta-image.jpg">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <!-- DEVELOPMENT FILES
  <link rel="stylesheet" type="text/css" href="../dist/css/meshki.min.css">
  <link rel="stylesheet" type="text/css" href="../dist/plugins/meshki-extra-button-colors.min.css">
  <script type="text/javascript" src="../dist/js/meshki.min.js"></script>
  DEVELOPMENT FILES -->
    <!-- PRODUCTION FILES -->
    <link rel="stylesheet" type="text/css" href="/cdn/meshki.min.css">
    <link rel="stylesheet" type="text/css" href="/cdn/meshki-extra-button-colors.min.css">
    <script type="text/javascript" src="/cdn/meshki.min.js"></script>
    <!-- PRODUCTION FILES -->
    <link rel="stylesheet" type="text/css" href="/custom.css">
    <link rel="stylesheet" type="text/css" href="/cdn/font-awesome.min.css">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="/cdn/prism.min.css">
    <link rel="stylesheet" href="/cdn/prism-okaidia.min.css">
    <link href="https://fonts.googleapis.com/css?family=Muli&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cinzel&display=swap" rel="stylesheet">
    <link href="https://emoji-css.afeld.me/emoji.css" rel="stylesheet">
    <script type="text/javascript" src="/PlayFabClientApi.js"></script>
    <script type="text/javascript" src="/PlayFabCustom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/json2html/1.3.0/json2html.min.js"></script>
    <script src="https://d3js.org/d3-dsv.v1.min.js"></script>
</head>

<body class="">

  <div class="sidenav push">
    <a href="javascript:void(0);" class="sidenav-close-button" onclick="meshki.closeSidenav()">&times;</a>
    <a href="index.html">Home</a>
    <div class="hide-on-mobile">
        <a href="https://discord.gg/2kW27Ez">Discord</a>
        <a href="https://twitter.com/beat_aim">Twitter</a>
        <a href="https://www.facebook.com/BeatAim/">Facebook</a>
    </div>
    <!-- <hr class="hide-on-non-mobile"> -->
    <div class="hide-on-non-mobile">
        <a href="/news" onclick="meshki.closeSidenav()">News</a>
        <a href="/next-update" onclick="meshki.closeSidenav()">Next update</a>
        <!-- <a href="make-account.html" onclick="meshki.closeSidenav()">Alpha sign up</a> -->
        <a href="/esports" onclick="meshki.closeSidenav()">Esports</a>
        <!-- <a href="redeem-key.html" onclick="meshki.closeSidenav()">Redeem alpha key</a> -->
        <a href="/extend-vip" onclick="meshki.closeSidenav()">Extend VIP</a>
        <a href="/referral">Referrals</a>
    </div>
    <hr>
    <!-- <button onclick="location.href='https://twitter.com/Meshki_UI'" class="button blue medium"><b></b><i class="fa fa-twitter" aria-hidden="true"></i></button>
  <button onclick="location.href='https://www.npmjs.com/package/meshki'" class="button red medium"><b>npm</b></button>
  <button onclick="location.href='https://github.com/Borderliner/Meshki'" class="button medium"><b></b><i class="fa fa-github" aria-hidden="true"></i></button> -->
    <a href="javascript:void(0)" disabled style="font-size: 1.5rem">Share on:</a>
    <div class="share-links">
        <a class="fb-share" href="https://www.facebook.com/sharer/sharer.php?u=http://beataim.com/" target="_blank"><i
                class="fa fa-facebook-square" aria-hidden="true"></i></a>
        <a class="tw-share" href="https://twitter.com/home?status=http://beataim.com/" target="_blank"><i
                class="fa fa-twitter-square" aria-hidden="true"></i></a>
        <a class="gp-share" href="https://plus.google.com/share?url=http://beataim.com/" target="_blank"><i
                class="fa fa-google-plus-square" aria-hidden="true"></i></a>
    </div>
</div>

  <div class="container">

    <div class="nav fixed">
    <ul>
        <li><a class="logo" href="javascript:void(0);" onclick="meshki.openSidenav()"><i class="fa fa-bars"
                    aria-hidden="true"></i>Beat Aim</a></li>
        <!-- <li class="nav-dropdown hide-on-mobile">
          <a href="javascript:void(0)" class="nav-dropdown-button">Plugins</a>
          <div class="nav-dropdown-content">
            <a href="rtl/">RTL Mode (Persian)</a>
            <a href="#extra-button-colors">Extra Button Colors</a>
          </div>
        </li> -->
        <div class="hide-on-mobile">
            <li><a href="/news">News</a></li>
            <li><a href="/next-update">Next update</a></li>
            <!-- <li><a href="make-account.html">Alpha sign up</a></li> -->
            <li><a href="/esports">Esports</a></li>
            <!-- <li><a href="redeem-key.html">Redeem alpha key</a></li> -->
            <li><a href="/extend-vip">Extend VIP</a></li>
            <li><a href="/referral">Referrals</a></li>
        </div>
        <!-- <li><a href="https://github.com/Borderliner/Meshki/blob/master/CHANGELOG.md">News</a></li>
        <li><a href="https://github.com/Borderliner/Meshki">GitHub</a></li> -->
        <!-- <li class="nav-dropdown hide-on-mobile">
          <a href="javascript:void(0)" class="nav-dropdown-button">Components</a>
          <div class="nav-dropdown-content">
            <a href="#buttons-doc">Buttons</a>
            <a href="#sidenav-doc">Sidenav</a>
            <a href="#navbar-doc">Navbar</a>
            <a href="#grid-doc">Grid System</a>
            <a href="#form-doc">Forms</a>
            <a href="#typography-doc">Typography</a>
            <a href="#tables-doc">Tables</a>
            <a href="#footer-doc">Footer</a>
          </div>
        </li> -->

        <li class="nav-right">
            <a href="https://store.steampowered.com/app/1142220/Beat_Aim__Rhythm_Aim_Trainer/" target="_blank"
                style="padding: 0px 10px">
                <img src="/imgs/steamearly.png" alt="BeatAimSteam" width="87px" height="34px">
            </a>
            <a href="https://discord.gg/2kW27Ez" target="_blank" style="padding: 0px 10px">
                <img src="/imgs/discord.png" alt="discord" width="38px" height="38px">
            </a>
            <a href="https://twitter.com/beat_aim" target="_blank" style="padding: 0px 10px">
                <img src="/imgs/twitter.png" alt="twitter" width="34px" height="34px">
            </a>
            <a href="https://www.facebook.com/BeatAim/" target="_blank" style="padding: 0px 10px">
                <img src="/imgs/fb.png" alt="facebook" width="34px" height="34px">
            </a>
        </li>

        <!-- <li class="nav-right hide-on-tablet">
          <script type="text/javascript" src="finder.js"></script>
          <input type="text" name="searchbox" id="searchbox" placeholder="Search..."
            onkeydown="meshkiUtil.search(this)">
        </li>
        <li class="nav-right hide-on-tablet"><button class="green" onclick="meshkiUtil.search(true)"><i
              class="fa fa-search" aria-hidden="true"></i></button></li> -->
    </ul>
</div>

    <div class="content">
<div class="row text-center">
    <h2>üèÖ Monthly League üèÜ</h2>
    <div id="timer"></div>
    <!-- <h3>Ends in:</h3>
    <h4 id="timer"></h4> -->
    <!-- <h3>Map pool:</h3> -->
    <!-- <h5>Dragon War - Darkest Hour - Freaks</h5> -->
    <div class="six offset-by-three col">
        <h6>Tournament starts a week after Monthly Update, exactly on 8th day and lasts till the end
            of the month.</h6>
        <h6>All non-vip leaderboards are combined together to reveal top 100 best players in Beat Aim.</h6>
    </div>
    <!-- <h3>Results:</h3> -->
    <!-- <p>The best players across all leaderboards, updated every 10 mins.</p>  -->
</div>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha256.js"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/hmac-sha256.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/hmac-sha256.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/enc-base64.min.js"></script>
<script type="text/javascript">

    // function shuffleArray(array) {
    //     for (let i = array.length - 1; i > 0; i--) {
    //         const j = Math.floor(Math.random() * (i + 1));
    //         [array[i], array[j]] = [array[j], array[i]];
    //     }
    // }
    async function main()
    {

        var t = "U2FsdGVkX18n+Uz1uB97JU15Va5bZASl6kXVcIyD6S8oEx3ANg6ywsCcW10y0iDMp0VM1RIB2p7gHzGGW0m+9QYdpBZpuo4RTWcM0PAVypo=";
        var div = document.createElement("div");
        div.className = "row text-center eight offset-by-two col";
        let htmlString = '';

        const tournamentsList = await (await fetch("game/tournamentsList.json")).json();
        AddPrizing(tournamentsList);
        await AddWinners(tournamentsList);

        AddRules();

        // div.insertAdjacentHTML('beforeend', '<br><h4>Current tournament ends in:</h4>');


        SetTimer();


        div.insertAdjacentHTML('beforeend', '<br><br><br><h4>Previous tournaments:</h4>');
        div.insertAdjacentHTML('beforeend', '<a href="tournamentsArchive/weekly1" >Weekly #1</a>');

        document.getElementsByClassName("content")[0].appendChild(div);


        function SetTimer()
        {
            var countDownDate;
            var today = new Date();
            var prefix;
            console.log(today.getDate());
            if (today.getDate() > 7 && today.getMonth() > 2)
            {
                prefix = "Ends in: ";
                var lastDayOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                countDownDate = lastDayOfMonth.getTime();
            }
            else
            {
                prefix = "Starts in: ";
                var EighthDayOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 8);
                countDownDate = EighthDayOfMonth.getTime();
            }
            // var countDownDate = new Date(tournamentsList.tournaments[tournamentsList.tournaments.length - 1].end).getTime();
            // var countDownDate = new  Date(tournamentsList.tournaments[0].end).getTime();
            // var countDownDate = new Date("Mon 11, 2019 12:00:00").getTime();

            var timerElement = document.getElementById("timer");
            if (timerElement)
            {
                var x = setInterval(function ()
                {
                    var now = new Date().getTime();
                    var distance = countDownDate - now;
                    var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    var seconds = Math.floor((distance % (1000 * 60)) / 1000);


                    // if (distance < 0)
                    // {
                    //     clearInterval(x);
                    //     timerElement.innerHTML = "Ended";
                    // }
                    // else
                    timerElement.innerHTML = prefix + days + "d " + hours + "h " + minutes + "m " + seconds + "s ";

                }, 1000);
            }
        }

        function AddPrizing(tList)
        {
            div.insertAdjacentHTML('beforeend', '<br><br><h3>Total Prizing:</h3>');
            div.insertAdjacentHTML('beforeend', `${tList.tournaments[tList.tournaments.length - 1].totalPrizePool}`);
            div.insertAdjacentHTML('beforeend', `<br><br><br><br>`);
        }

        async function AddWinners(tList)
        {
            div.insertAdjacentHTML('beforeend', '<h3>Ranking:</h3>');
            div.insertAdjacentHTML('beforeend', `(resets on tournament start)<br>`);

            try
            {
                htmlString += '<table class="expand hoverable" id="table-example"> \
            <thead>\
              <tr>\
                <th>Place</th>\
                <th>Player</th>\
                <th>Score</th>\
                <th>Prize</th>\
                <th>Country</th>\
              </tr>\
            </thead>\
            <tbody>';

                // topPlayers = await response.json();
                // topPlayers = JSON.parse('[["XVoIR",3000],["Brumor",2951,"https://youtu.be/PbpKACOuSXo?t=1552"],["HoundFPS",2929],["jwun",2902],["FallenAng3L",2885],["meeko",2862],["Naoki",2856],["Nayllo",2820],["XensKittyCat",2771],["autumns",2745]]');
                // var winnersJson = JSON.parse(tournamentsList.tournaments[1].winnersJson);
                // var winnersJsonString = await (await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vTovzEFnaeJtKjxwdWwQQwgxbPTH_9_UnLbxWTnJruUnSAKFGBm9bQtbZw87EYCLH7FsbdVAVBMAxRH/pub?output=tsv")).text();
                // var winnersJsonString = `Name	SteamId	Country	Score
                // Leviathan	76561198084022633	US	468
                // Pyroxia	76561198133585151	TR	466
                // Sosik	76561198093456452	US	465
                // GlycerinDawn	76561198864176237	US	459
                // Nayllo	76561198165098634		457
                // Merryeliot[FR]	76561198106672504		447
                // Kamyker	76561198053936045	PL	445
                // ImSorry	76561198141855723		411
                // FallenMystery15	76561198844204184		396
                // KNIGHT	76561198985195690		395
                // eck	76561198097149970	US	379
                // djmon007	76561198119137613	US	377
                // Rancid Ranch	76561198434726804	US	368
                // Syssnow	76561198219523784	FR	363`;


                // window.localStorage.getItem("MonthlyLeague")
                var accessData = GrtAzureAccessData("MonthlyLeagueTsv", "Leaderboard");

                // console.log(accessData.Url);
                // for (var key in accessData.Headers)
                // {
                //     var value = accessData.Headers[key];

                //     console.log(key + ": " + value);
                //     // do something with "key" and "value" variables
                // }
                var winnersJsonString = await fetch(accessData.Url, { headers: accessData.Headers });

                // var winnersJsonString = await (await fetch(CryptoJS.AES.decrypt(t, 'https://beataim.com/leaderboard.json').toString(CryptoJS.enc.Utf8))).text();
                // localStorage.setItem('myCat', 'Tom');
                // var winnersJsonString = await (await fetch("http://localhost:7071/api/GetMonthlyLeague")).text();
                // console.log(winnersJsonString);
                var data = d3.tsvParse(JSON.parse(winnersJsonString).Value);
                for (let i = 0; i < data.length; i++)
                {
                    var place;
                    switch (i)
                    {
                        case 0:
                            place = "ü•á";
                            break;
                        case 1:
                            place = "ü•à";
                            break;
                        case 2:
                            place = "ü•â";
                            break;
                        default:
                            place = i + 1;
                    }

                    htmlString += `<tr><td>${(place)}</td>` +
                        `<td>${(data[i].Name ?? '-')}</td>` +
                        `<td>${(data[i].Score ?? '-')}</td>` +
                        `<td>${(tList.tournaments[tList.tournaments.length - 1].prizePerPlace[i] ?? "")}</td>`
                    // if (data[i].link)
                    // {
                    //     var site = "YouTube"
                    //     if (data[i].link.includes("twitch"))
                    //         site = "Twitch";
                    //     htmlString += `<td><a href="${data[i].link}" target="_blank">${site}</a></td></tr>`
                    // }
                    // else
                    //     htmlString += `<td>-</td></tr>`
                    var country = data[i].Country
                    if (country)
                    {
                        if (country == "us")
                            htmlString += `<td><i class="em em-${data[i].Country.toLowerCase()}" aria-role="presentation"></i></td></tr>`
                        else
                            htmlString += `<td><i class="em em-flag-${data[i].Country.toLowerCase()}" aria-role="presentation"></i></td></tr>`
                    }
                    else
                        htmlString += `<td></td></tr>`
                    // if (index > 0 && index + 1 % 3 === 0)
                    // else if (index + 1 < topPlayers.length)
                    //     htmlString += ' ';

                }

            } catch (error)
            {
                htmlString += 'error :(';
                console.log(error)
            }
            htmlString += '</tbody>\
          </table>';
            div.insertAdjacentHTML('beforeend', htmlString);
        }

        function AddRules()
        {
            div.insertAdjacentHTML('beforeend', '<br><h3>Rules:</h3>');
            div.insertAdjacentHTML('beforeend', `<p>All players are required to link a video to at least one of their top leaderboard placements.</p>`);
            div.insertAdjacentHTML('beforeend', `<p>Players winning real $$$ prizes have to link at least 5 videos.</p>`);
            div.insertAdjacentHTML('beforeend', `<p>Videos should be set to public (not unlisted or private).</p>`);
        }
    }
    main();


    function GrtAzureAccessData(documentId, partitionKey)
    {
        var readOnlyKey = "dC6FZTJPFC2iTteFH2aDHWStanmK7vOVg0qlbKXE2weg3NEo1N9Sh6SoT8cumP7NWHm6mqDfco55sVItSJphzQ==";
        var date = new Date().toUTCString()

        var collectionId = "main";
        var databaseId = "main";
        var verb = "GET";
        var resourceType = "docs";
        var resourceLink = `dbs/${databaseId}/colls/${collectionId}/docs/${documentId}`;

        var resourceId = resourceLink;

        var token = GenerateMasterKeyAuthorizationSignature(verb, resourceId, resourceType, readOnlyKey, "master", "1.0", date);

        return {
            Url: `https://beataim.documents.azure.com/${resourceLink}`,
            Headers:
            {
                "Authorization": token,
                "x-ms-date": date,
                "x-ms-version": "2018-12-31",
                "x-ms-documentdb-partitionkey": `[\"${partitionKey}\"]`
            }
        };
    }

    function GenerateMasterKeyAuthorizationSignature(verb, resourceId, resourceType, key, keyType, tokenVersion, date)
    {
        // date = "Tue, 24 Mar 2020 21:45:00 GMT";
        // var hash = CryptoJS.HmacSHA256("Message", "secret");
        // var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
        // document.write(hashInBase64);
        var payLoad = `${verb.toLowerCase()}\n${resourceType.toLowerCase()}\n${resourceId}\n${date.toLowerCase()}\n${""}\n`;
        // var wordsKey = CryptoJS.enc.Hex.parse(key);
        // var hashPayLoad = CryptoJS.HmacSHA256(payLoad, wordsKey);
        var hash = CryptoJS.HmacSHA256(CryptoJS.enc.Utf8.parse(payLoad), CryptoJS.enc.Base64.parse(key));
        // string signature = Convert.ToBase64String(hashPayLoad);
        var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
        // console.log(hashInBase64);
        // console.log(hashInBase64.toString(CryptoJS.enc.Base64));

        return encodeURIComponent(`type=${keyType}&ver=${tokenVersion}&sig=${hashInBase64}`);
    }

</script>

</div>
<div class="footer " style="font-size: 10px">
    <div class="row text-center">
        <div class=" six col ">
            <span>Created using Meshki by <a href=" https://github.com/Borderliner" target="_blank">Borderliner </a>
            </span> </div>
        <div class="six col">
            <span>Few icons by <a href="http://www.freepik.com/" target="_blank">Freepik</a> from <a
                    href="http://www.flaticon.com/" target="_blank">www.flaticon.com </a></span>
        </div>
    </div>
</div>

<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>
<script type="text/javascript">
  // var percent_update = function () {
  //   document.getElementById("percent_value").innerHTML = this.value;
  //   console.log(this.value);
  // };

  // document.getElementById("percent").onchange = percent_update;
  // document.getElementById("percent").oninput = percent_update;

  var clipboard = new Clipboard('.clipboard-btn');
  clipboard.on('success', function (e) {
    var classArray = e.trigger.className.split(' ');
    classArray.splice(classArray.indexOf('blue'), 1);
    classArray.push('green');
    e.trigger.className = classArray.join(' ');
    e.trigger.innerHTML = '<i class="fa fa-check" aria-hidden="true"></i> Copied';

    window.setTimeout(function () {
      var classArray = e.trigger.className.split(' ');
      classArray.splice(classArray.indexOf('green'), 1);
      classArray.push('blue');
      e.trigger.className = classArray.join(' ');
      e.trigger.innerHTML = '<i class="fa fa-clipboard" aria-hidden="true"></i>';
    }, 2000);
  });

  clipboard.on('error', function (e) {
    var classArray = e.trigger.className.split(' ');
    classArray.splice(classArray.indexOf('blue'), 1);
    classArray.push('red');
    e.trigger.className = classArray.join(' ');
    e.trigger.innerHTML = '<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Error';

    window.setTimeout(function () {
      var classArray = e.trigger.className.split(' ');
      classArray.splice(classArray.indexOf('red'), 1);
      classArray.push('blue');
      e.trigger.className = classArray.join(' ');
      e.trigger.innerHTML = '<i class="fa fa-clipboard" aria-hidden="true"></i>';
    }, 2000);
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
</body>

</html>